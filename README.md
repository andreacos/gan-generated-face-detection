# Detection of GAN-generated images by means of XCeption-Net

![Image](./resources/vippdiism.png)

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the
implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
more details. You should have received a copy of the GNU General Public License along with this program.
If not, see <http://www.gnu.org/licenses/>.

If you are using this software, please cite:

    Boosting CNN-based primary quantization matrix estimation of double JPEG images via a classification-like architecture}, 
    Benedetta Tondi and Andrea Costanzo and Dequ Huang and Bin Li
    ArXiv preprint: https://arxiv.org/abs/2012.00468
    
The software uses [XCeptionNet](arxiv.org/abs/1610.02357) to detect if an image is real or generated by a GAN.

## Pre-trained model
You can download a pre-trained model [here]().

## Datasets
The pre-trained model has been trained/tested with the following dataset
- 100000 GAN generated faces with [Nvidia StyleGan2](https://github.com/NVlabs/stylegan2) using config-f mode, i.e. *stylegan2-ffhq-config-f.pkl*, and truncations_psi in [0.3, 0.4, 0.5, 0.6, 0.65, 0.7, 0.75, 0.8, 0.9, 1]
- 100000 REAL faces (70000 from [FlickrFaceHQ dataset](https://github.com/NVlabs/ffhq-dataset) and 30000 from [CelebAHQ dataset](github.com/tkarras/progressive_growing_of_gans).

90% of the images have been used for training and 10% for testing (randomly selected)
All the images have been resized from 1024x1024x3 to the size of 299x299x3 before training/test.

## Training
To train a new model, use the script (Train_xception.py)[https://github.com/andreacos/gan-generated-face-detection/blob/main/Train_xception.py]. To modify training parameters, edit (configuration.py)[https://github.com/andreacos/gan-generated-face-detection/blob/main/configuration.py].

- Network model: XCeptionNet  
- Input size 299x299x3, all images are scaled with bicubic interpolation
- Output size: 2 nodes (NOT GAN: label 0 and GAN: label 1)
- Training batch size = 16
- Trained initial model for 3 epochs without data augmentation
- Fine-tuned pre-trained model for 10 epochs with random data augmentation
- JPEG compression with probability 50% with random quality in [70, 99] (step 1)
- Left/right flip with probability 20% (50% probability to flip left or right)
- Rotation with probability 30% with random angle in [-15, 15] (step 1)
- Resize with probability 80% with random scale factor in [0.8, 1.3] (step 0.1, bicubic interpolation)
- Only one augmentation from JPEG, RESIZE and FLIP for each image of the batch, resize (with prob. 80%) on each image

